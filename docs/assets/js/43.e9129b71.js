(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{376:function(s,a,t){"use strict";t.r(a);var n=t(12),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-命令简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令简介"}},[s._v("#")]),s._v(" 1.命令简介")]),s._v(" "),a("p",[s._v("history 用于显示用户以前执行过的历史命令，并且能对历史命令进行追加和删除等操作。")]),s._v(" "),a("p",[s._v("单独使用 history 时，仅显示历史命令。在命令行中，可以使用感叹号 ! 执行指定序号的历史命令。如执行序号为 2 个历史命令，则输入"),a("code",[s._v("!2")]),s._v("。")]),s._v(" "),a("p",[s._v("历史命令是被保存在内存中的，当退出或者登录shell时，会自动保存或读取。在内存中，历史命令仅能够存储 1000 条历史命令，该数量是由环境变量 HISTSIZE 进行控制。")]),s._v(" "),a("h2",{attrs:{id:"_2-命令格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令格式"}},[s._v("#")]),s._v(" 2.命令格式")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("history [n]\nhistory -c\nhistory -d offset\nhistory -anrw [filename]\nhistory -p arg [arg ...]\nhistory -s arg [arg ...]\n")])])]),a("h2",{attrs:{id:"_3-选项说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-选项说明"}},[s._v("#")]),s._v(" 3.选项说明")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v("\n\t将当前 Shell 会话的历史命令追加到命令历史文件中，命令历史文件是保存历史命令的配置文件。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v("\n\t清空当前历史命令列表。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("offset"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\t删除历史命令列表中指定序号的命令。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v("\n\t从命令历史文件中读取本次 Shell 会话开始时没有读取的历史命令。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\n\t读取命令历史文件到当前的 Shell 历史命令内存缓冲区。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-s")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t将指定的命令作为单独的条目加入命令历史内存缓冲区。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\t对指定参数执行历史替换，并在标准输出中显示结果。不将结果存储在历史记录列表中。每个参数必须被引用以禁用正常的历史扩展。\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v("\n\t把当前的 Shell 历史命令内存缓冲区的内容写入命令历史文件。\n")])])]),a("h2",{attrs:{id:"_4-常用示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-常用示例"}},[s._v("#")]),s._v(" 4.常用示例")]),s._v(" "),a("p",[s._v("（1）查看历史命令。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-10-16 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":54:59 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-10-16 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":55:15 lsb_release\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-10-16 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":55:40 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/*release\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-10-16 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(":56:02 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/centos-release\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),a("p",[s._v("（2）显示最近 N 条命令。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2465")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":55:43 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2466")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":55:55 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HISTSIZE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2467")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":08:21 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2468")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":08:27 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("less")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2469")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":10:27 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])])]),a("p",[s._v("（3）将当前 Shell 历史命令写入到历史文件中。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v("\n")])])]),a("p",[s._v("（4）读取命令历史文件到当前的 Shell 历史命令内存缓冲区。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v("\n")])])]),a("p",[s._v("（5）删除所有条目从而清空历史列表。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v("\n")])])]),a("p",[s._v("（6）执行历史列表中指定下标的命令。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":23:26 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":23:34 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":25:02 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":25:08 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2022")]),s._v("-12-19 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v(":25:12 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\ncentos7.sh  cosfs.sh  cpp  dnspod.sh  go  install_panel.sh  install.sh  LATEST.tar.gz  libsodium-stable  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v("  txcdn.sh\n")])])]),a("p",[s._v("（7）执行最近一条历史命令。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n")])])]),a("h2",{attrs:{id:"_5-拓展知识"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-拓展知识"}},[s._v("#")]),s._v(" 5.拓展知识")]),s._v(" "),a("h3",{attrs:{id:"_5-1-常用设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-常用设置"}},[s._v("#")]),s._v(" 5.1 常用设置")]),s._v(" "),a("p",[s._v("对 history 设置与相关环境变量有关。")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTCONTROL")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ignoredups               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 消除命令历史中的连续重复条目")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTSIZE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁用history命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTCONTROL")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("erasedups                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在整个历史中去除重复命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTFILESIZE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置历史文件大小")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HISTTIMEFORMAT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%F %T'")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置时间戳，执行后生效")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HISTTIMEFORMAT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%F %T '),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("whoami")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v('"')]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示执行用户,对管理员很有用")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("HISTIGNORE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("“pwd:ls:”               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略特殊命令,只忽略ls并不忽略ls -lart")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTCONTROL")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ignorespace              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 忽略某条特定命令")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTFILE")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/root/history.txt           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置历史文件的存储目录")]),s._v("\n")])])]),a("h3",{attrs:{id:"_5-2-常用参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-常用参数"}},[s._v("#")]),s._v(" 5.2 常用参数")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("!!　　　　      # 前一条命令；\n!:0 　　　      # 不带参数的前一条命令名；\n!^ 　　　       # 前一条命令的第一个参数；\n!:n 　　　      # 前一条命令的第n个参数；\n!$ 　　　       # 前一条命令的最后一个参数；例如 mkdir test; cd !$\n!*              # 前一条命令的所有参数，命令名除外；\n!n 　　　       # 第 n 条命令；\n!-n 　　　      # 倒数第n条命令；\n!str　　　      # 最近一条以str开头的命令；\n!?str　 　      # 最近一条包含str的命令；\n^a^b　　        # 将上一条命令名中的a替换为b；\n!:gs/a/b　      # 将上一条命令的所有a替换为b（包含命令名和参数）。                        \n!:3             # 第三个参数数\n!:2-4           # 第2到4个参数\n!:-3            # 从第0个到第三个参数\n!*              # 第一个到最后一个参数\n!:2*            # 第2个到最后一个\n!:2-            # 从第2个开始，但不要结尾参数\n")])])]),a("hr"),s._v(" "),a("h2",{attrs:{id:"参考文献"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[s._v("#")]),s._v(" 参考文献")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.man7.org/linux/man-pages/man1/bash.1.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("bash(1) - Linux manual page - man7.org"),a("OutboundLink")],1)]),s._v(" "),a("Vssue",{attrs:{title:"history-builtin"}})],1)}),[],!1,null,null,null);a.default=e.exports}}]);